{
  "id": "admission",
  "canonicalName": "admission-machine",
  "initials": [
    "U:admission-in-waiting-confirmation"
  ],
  "description": "Define all flows of an admission",
  "version": "0.1.0",
  "universes": {
    "admission-in-waiting-confirmation": {
      "id": "admission-in-waiting-confirmation",
      "canonicalName": "admission-in-waiting-confirmation",
      "version": "0.1.0",
      "initial": "CREATED",
      "metadata": {
        "templateId": "template1"
      },
      "realities": {
        "CREATED": {
          "id": "CREATED",
          "type": "transition",
          "always": [
            {
              "targets": [
                "WAITING_CONFIRMATION"
              ]
            }
          ]
        },
        "WAITING_CONFIRMATION": {
          "id": "WAITING_CONFIRMATION",
          "type": "transition",
          "on": {
            "confirm": [
              {
                "targets": [
                  "CONFIRMED"
                ]
              }
            ],
            "reject": [
              {
                "targets": [
                  "U:admission-rejected"
                ]
              }
            ]
          }
        },
        "CONFIRMED": {
          "id": "CONFIRMED",
          "type": "final",
          "always": [
            {
              "targets": [
                "U:admission-form-process",
                "U:admission-contract-process"
              ]
            }
          ]
        }
      }
    },

    "admission-form-process": {
      "id": "admission-form-process",
      "canonicalName": "admission-form-process",
      "version": "0.1.0",
      "initial": "FILLING_FORM",
      "metadata": {
        "templateId": "template2",
        "templateType": "qualtrics",
        "templateLabel": "Form Process",
        "templateOrder": 1
      },
      "realities": {
        "FILLING_FORM": {
          "id": "FILLING_FORM",
          "type": "transition",
          "on": {
            "fill-form": [
              {
                "targets": [
                  "FILLED"
                ]
              }
            ],
            "manual-complete": [
              {
                "targets": [
                  "FILLED"
                ]
              }
            ]
          }
        },
        "FILLED": {
          "id": "FILLED",
          "type": "final",
          "always": [
            {
              "targets": [
                "U:admission-waiting-processes:WAITING_PROCESSES"
              ]
            }
          ]
        }
      }
    },

    "admission-contract-process": {
      "id": "admission-contract-process",
      "canonicalName": "admission-contract-process",
      "version": "0.1.0",
      "initial": "SIGNING_DATA_CONSENT",
      "metadata": {
        "templateId": "template3",
        "templateType": "contract",
        "templateLabel": "Contract Process",
        "templateOrder": 2
      },
      "realities": {
        "SIGNING_DATA_CONSENT": {
          "id": "SIGNING_DATA_CONSENT",
          "type": "transition",
          "on": {
            "sign": [
              {
                "targets": [
                  "DATA_CONSENT_SIGNED"
                ]
              }
            ],
            "manual-complete": [
              {
                "targets": [
                  "SIGNING_DATA_CONSENT"
                ]
              }
            ]
          }
        },
        "DATA_CONSENT_SIGNED": {
          "id": "DATA_CONSENT_SIGNED",
          "type": "transition",
          "always": [
            {
              "targets": [
                "U:admission-waiting-processes:WAITING_PROCESSES"
              ]
            }
          ]
        },
        "SIGNING_ENROLLMENT_CONTRACT": {
          "id": "SIGNING_ENROLLMENT_CONTRACT",
          "type": "transition",
          "on": {
            "sign": [
              {
                "targets": [
                  "CONTRACT_SIGNED"
                ]
              }
            ],
            "manual-complete": [
              {
                "targets": [
                  "CONTRACT_SIGNED"
                ]
              }
            ]
          }
        },
        "CONTRACT_SIGNED": {
          "id": "CONTRACT_SIGNED",
          "type": "final",
          "always": [
            {
              "targets": [
                "U:admission-completed"
              ]
            }
          ]
        }
      }
    },

    "admission-waiting-processes": {
      "id": "admission-waiting-processes",
      "canonicalName": "waiting-processes",
      "version": "0.1.0",
      "metadata": {
        "templateId": "template4"
      },
      "realities": {
        "WAITING_PROCESSES": {
          "id": "WAITING_PROCESSES",
          "type": "transition",
          "observers": [
            {
              "src": "builtin:observer:containsAllEvents",
              "args": {
                "p1": "fill-form",
                "p2": "sign"
              }
            },
            {
              "src": "builtin:observer:containsAllEvents",
              "args": {
                "p1": "manual-complete"
              }
            }
          ],
          "always": [
            {
              "targets": [
                "U:admission-contract-process:SIGNING_ENROLLMENT_CONTRACT"
              ]
            }
          ]
        }
      }
    },

    "admission-rejected": {
      "id": "admission-rejected",
      "canonicalName": "admission-rejected",
      "version": "0.1.0",
      "initial": "REJECTED",
      "metadata": {
        "templateId": "template5"
      },
      "realities": {
        "REJECTED": {
          "id": "REJECTED",
          "type": "unsuccessfulFinal",
          "entryActions": [
            {
              "src": "disableAdmission",
              "description": "Set admission context to disabled"
            }
          ]
        }
      }
    },

    "admission-cancelled": {
      "id": "admission-cancelled",
      "canonicalName": "admission-cancelled",
      "version": "0.1.0",
      "metadata": {
        "templateId": "template6"
      },
      "realities": {
        "CANCELLED": {
          "id": "CANCELLED",
          "type": "unsuccessfulFinal",
          "entryActions": [
            {
              "src": "disableAdmission",
              "description": "Set admission context to disabled"
            }
          ]
        }
      }
    },

    "admission-completed": {
      "id": "admission-completed",
      "canonicalName": "admission-completed",
      "version": "0.1.0",
      "metadata": {
        "templateId": "template7"
      },
      "realities": {
        "COMPLETED": {
          "id": "COMPLETED",
          "on": {
            "cancel": [
              {
                "targets": [
                  "U:admission-cancelled"
                ]
              }
            ]
          },
          "type": "final"
        }
      }
    }
  }
}